(function(a){a.quickAPI=function(b){var b=b||new Object();b.args=b.args||{method:"quickapi.test"};var e,c={type:b.type||"POST",async:b.sync===true?false:b.async===false?false:true,timeout:b.timeout||window.AJAX_TIMEOUT||3000,url:b.url||window.QUICKAPI_URL||"/api/",data:{jsonData:a.toJSON(b.args),language:b.language||window.LANGUAGE_CODE,},dataType:"json",},f=b.callback||function(h,g,i){},d=b.handlerShowAlert||window.handlerShowAlert||function(j,k,h,g){var i;if(a.type(k)=="object"){k=a.toJSON(k).replace(/\,\"/g,', "').replace(/\"\:/g,'": ')}else{if(k.match(/<\!DOCTYPE/)){i=k.match(/<[title,TITLE]+>(.*)<\/[title,TITLE]+>/);if(i){j=i[1]}i=k.match(/<[body,BODY]+>([^+]*)<\/[body,BODY]+>/);if(i){k=i[1].replace(/<\/?[^>]+>/g,"").replace(/ [ ]+/g," ").replace(/\n[\n]+/g,"\n")}}}if(k.length>512){k=k.substring(0,512)+" ..."}alert(j+"\n"+k);if(g){return g()}return null};e=a.ajax(c).fail(function(i,g,h){if(i.getResponseHeader("Location")){window.location.replace(i.getResponseHeader("Location").replace(/\/[\#\-\w]*$/,"/?").replace(/\?.*$/,"?next="+window.location.pathname));console.info("REDIRECT:"+i.getResponseHeader("Location"))}else{if(i.responseText){console.error("ERROR:",i.responseText);d("ERROR:",i.responseText,"alert-danger")}}}).done(function(i,h,j){if(b.log&&window.DEBUG){console.debug(b.log)}if((i.status>=300)&&(i.status<400)&&(i.data.Location!=undefined)){var g=i.data.Location.replace(/\/[\#\-\w]*$/,"/?").replace(/\?.*$/,"?next="+window.location.pathname),k=function(){window.location.replace(g)};console.info("REDIRECT:"+g);if(i.message){d("REDIRECT:",i.message,"alert-danger",k)}else{k()}}else{if(i.status>=400){d("ERROR:",i.message,"alert-danger")}else{if(window.DEBUG){console.debug(a.toJSON(i.message));if(b.args.method=="quickapi.test"){console.debug(i.data)}}return f(i,h,j)}}});return e}}(jQuery));